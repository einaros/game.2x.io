var Factory=function(){function k(a,b){this.world=a,this.physicsScale=b}var a=Box2D.Common.Math.b2Vec2,b=Box2D.Dynamics.b2BodyDef,c=Box2D.Dynamics.b2Body,d=Box2D.Dynamics.b2FixtureDef,e=Box2D.Dynamics.b2Fixture,f=Box2D.Dynamics.b2World,g=Box2D.Collision.Shapes.b2MassData,h=Box2D.Collision.Shapes.b2PolygonShape,i=Box2D.Collision.Shapes.b2CircleShape,j=Box2D.Collision.Shapes.b2EdgeChainDef;k.prototype.createPolygonActor=function(e,f,g,i){i=i||{};var j={min:null,max:null},k={min:null,max:null};for(var l=0;l<e.length;++l){var m=e[l];if(j.min==null||m.x<j.min)j.min=m.x;if(j.max==null||m.x>j.max)j.max=m.x;if(k.min==null||m.y<k.min)k.min=m.y;if(k.max==null||m.y>k.max)k.max=m.y}var n=k.min-valOrDef(i.bottomPadding,50),o=j.max-j.min,p=k.max-n,q=this.physicsScale,r=function(a){return(a-o/2)/q},s=function(a){return 30+(a-p/2)/q},t=new b;t.position.Set(f/this.physicsScale,g/this.physicsScale),i.fixed||(t.type=c.b2_dynamicBody);var u=this.world.CreateBody(t),v=new d,w=v.shape=new h;v.restitution=valOrDef(i.restitution,.5),i.fixed||(v.density=valOrDef(i.density,1)),v.friction=valOrDef(i.friction,1);var x=[];for(var l=e.length-1;l>=0;--l){var m=e[l],y=new a;y.Set(r(m.x),s(m.y)),x.push(y)}x.push(new a(r(e[0].x),s(n))),x.push(new a(r(e[e.length-1].x),s(n))),w.SetAsArray(x,x.length),u.CreateFixture(v);return u},k.prototype.createChainActor=function(e,f,g,i,j){j=j||{};var k={min:null,max:null},l={min:null,max:null};for(var m=0;m<e.length;++m){var n=e[m];if(k.min==null||n.x<k.min)k.min=n.x;if(k.max==null||n.x>k.max)k.max=n.x;if(l.min==null||n.y<l.min)l.min=n.y;if(l.max==null||n.y>l.max)l.max=n.y}var o=k.max-k.min,p=l.max-l.min,q=this.physicsScale,r=function(a){return(f-o/2+a)/q},s=function(a){return(g+a)/q},t=new b;j.fixed||(t.type=c.b2_dynamicBody);var u=[],v=new d;v.shape=new h,v.restitution=valOrDef(j.restitution,.5),j.fixed||(v.density=valOrDef(j.density,1)),v.friction=valOrDef(j.friction,1);for(var m=1,w=e.length;m<w;++m){var x=new a(e[m-1].x,e[m-1].y),y=new a(e[m].x,e[m].y);y.Subtract(x);var o=y.Length()/q;t.position.x=r(x.x+y.x/2),t.position.y=s(x.y+y.y/2);var z=this.world.CreateBody(t);z.SetAngle(Math.atan(y.y/y.x));var A=v.shape=new h;A.SetAsBox(o/2,i/2/q),z.CreateFixture(v),u.push(z)}return u},k.prototype.createCubeActor=function(a,b,c,d,e,f,g){g=g||{};var h=this.createPhysicsCube(a,b,d,e,g);h.object=this.createCube(new THREE.Vector3(a,b,c),new THREE.Vector3(d,e,f),g);return h},k.prototype.createSphereActor=function(a,b,c,d,e){e=e||{};var f=this.createPhysicsSphere(a,b,c,e);f.object=this.createSphere(a,new THREE.Vector3(b,c,d),e);return f},k.prototype.createPhysicsCube=function(a,e,f,g,i){i=i||{};var j=new b;j.position.Set(f/this.physicsScale,g/this.physicsScale),i.fixed||(j.type=c.b2_dynamicBody);var k=this.world.CreateBody(j),l=new d;l.shape=new h,l.shape.SetAsBox(a/2/this.physicsScale,e/2/this.physicsScale),l.restitution=valOrDef(i.restitution,.5),i.fixed||(l.density=valOrDef(i.density,1)),l.friction=valOrDef(i.friction,1),k.CreateFixture(l),k.w=1,k.h=1;return k},k.prototype.createPhysicsSphere=function(a,e,f,g){g=g||{};var h=new b;h.position.Set(e/this.physicsScale,f/this.physicsScale),g.fixed||(h.type=c.b2_dynamicBody);var j=this.world.CreateBody(h),k=new d;k.shape=new i(a/this.physicsScale),k.restitution=valOrDef(g.restitution,.5),g.fixed||(k.density=valOrDef(g.density,1)),k.friction=valOrDef(g.friction,1),j.CreateFixture(k),j.w=1,j.h=1;return j},k.prototype.createCube=function(a,b,c){var d=new THREE.Mesh(new THREE.CubeGeometry(a.x,a.y,a.z,valOrDef(c.segmentsX,1),valOrDef(c.segmentsY,1),valOrDef(c.segmentsZ,1)),c.material||new THREE.MeshLambertMaterial({color:16777215}));d.position=b,d.castShadow=!0,d.receiveShadow=!0;return d},k.prototype.createSphere=function(a,b,c){var d=new THREE.Mesh(new THREE.SphereGeometry(a,valOrDef(c.segmentsW,20),valOrDef(c.segmentsH,20)),c.material||new THREE.MeshLambertMaterial({color:16777215}));d.castShadow=!0,d.receiveShadow=!0,d.position=b;return d};return k}()