var Coordinator=function(){var a={init:function(){if(!Detector.webgl)showSplash("<center>It appears that your browser or graphics card doesn't fully support WebGL.\nTry a new version of Chrome or FireFox -- or wait for more widespread support :)\n\nSorry for the inconvenience!</center>",-1,!0);else{var a=$("<div>"),b=$("#scene");b.append(a);var c=$("#info");showSplash('<center>This is the start of a WebGL game, utilizing Three.js and box2d.\nFor the time being it isn\'t very feature rich - but that will change in time!\n\nStart out by drawing yourself a map below, from the left to the\nright edge, then get rolling!\n\nNote that while multiple browsers now support WebGL,\nI\'ve found that Chrome renders this best.\n\nFor updates, hit me up on twitter: <a href="http://twitter.com/einaros" target="_blank">@einaros</a>.</center>',-1,!0),this.getMapDrawing(Game.config.mapWidth,Game.config.mapSegments,a,function(b){Game.init(a[0],b)})}},getMapDrawing:function(a,b,c,d){function p(c){var e=[],f=b+1,h=c.length/f,i=paper.view.size.width,j=paper.view.size.height,k=a/i,l=j/2;for(var m=0;m<f;++m){var n=c.getPointAt(m*h).y;n=(j-n-l)*k,e.push(n)}g.remove(),d(e)}var e=[],f=10/30,g=$("<canvas>");g.css({background:"#888888",cursor:"pointer"});var h=$(window);h.resize(function(){var a=h.width(),b=h.height();a*f>b?a=b/f:b=a*f,g.prop("width",a),g.prop("height",b)}),h.resize(),c.append(g[0]),paper.setup(g[0]);var i=20,j=20,k=new paper.Path.Rectangle(new paper.Rectangle(new paper.Point(0,0),new paper.Point(i,paper.view.size.height)));k.fillColor="#aaaaaa";var l=new paper.Path.Rectangle(new paper.Rectangle(new paper.Point(paper.view.size.width-j,0),new paper.Point(paper.view.size.width,paper.view.size.height)));l.fillColor="#aaaaaa";var m=-1,n=new paper.Path,o=new paper.Tool;paper.view.draw(),o.onMouseDown=function(a){if(a.point.x>0&&a.point.x<i)k.fillColor="#aaffaa";else{k.fillColor="#ffaaaa",showSplash("start your path within the far left rectangle",1e3);return}m=-1,n.removeSegments(),n.strokeColor="white",n.add(a.point),o.onMouseDrag=function(a){var b=a.point;m>b.x&&(b.x=m),m=b.x,n.add(b)},o.onMouseUp=function(a){o.onMouseDrag=null,o.onMouseUp=null,n.simplify();if(a.point.x>paper.view.size.width-j)l.fillColor="#aaffaa",p(n);else{l.fillColor="#ffaaaa",n.removeSegments(),showSplash("end your path within the far right rectangle",1e3);return}}}},initGame:function(){}};return a}()