var Coordinator=function(){var a={init:function(){if(!Detector.webgl)showSplash("<center>It appears that your browser or graphics card doesn't fully support WebGL.\nTry a new version of Chrome or FireFox -- or wait for more widespread support :)\n\nSorry for the inconvenience!</center>",-1,!0);else{var a=$("<div>"),b=$("#scene");b.append(a);var c=$("#info");showSplash('<center>This is the start of a WebGL game, utilizing Three.js and box2d.\nFor the time being it isn\'t very feature rich - but that will change in time!\n\nStart out by drawing yourself a map below, from the left to the\nright edge, then get rolling!\n\nNote that while multiple browsers now support WebGL,\nI\'ve found that Chrome renders this best.\n\nFor updates, hit me up on twitter: <a href="http://twitter.com/einaros" target="_blank">@einaros</a>.</center>',-1,!0),this.getMapDrawing(Game.config.mapWidth,Game.config.mapSegments,a,function(b){Game.init(a[0],b)})}},getMapDrawing:function(a,b,c,d){function r(c){h.unbind(".drawmap");var e=[],f=b+1,i=c.length/f,j=paper.view.size.width,k=paper.view.size.height,l=a/j,m=k/2;for(var n=0;n<f;++n){var o=c.getPointAt(n*i).y;o=(k-o-m)*l,e.push(o)}g.remove(),d(e)}var e=[],f=.5,g=$("<canvas>");g.css({background:"#888888",cursor:"pointer"});var h=$(window);h.bind("resize.drawmap",function(){var a=h.width(),b=h.height();a*f>b?a=b/f:b=a*f,g.prop("width",a),g.prop("height",b)}),h.resize(),c.append(g[0]),paper.setup(g[0]);var i=20,j=20,k=new paper.Path.Rectangle(new paper.Rectangle(new paper.Point(0,0),new paper.Point(i,paper.view.size.height)));k.fillColor="#aaaaaa";var l=new paper.PointText(new paper.Point(i/2,paper.view.size.height/2));l.fillColor="white",l.content="Start Drawing Here!",l.rotate(-90),l.position.x=.5*(i+7),l.position.y=.5*(paper.view.size.height+110);var m=new paper.Path.Rectangle(new paper.Rectangle(new paper.Point(paper.view.size.width-j,0),new paper.Point(paper.view.size.width,paper.view.size.height)));m.fillColor="#aaaaaa";var n=new paper.PointText(new paper.Point(0,0));n.fillColor="white",n.content="End Drawing Here!",n.rotate(-90),n.position.x=paper.view.size.width-.5*(j-10),n.position.y=.5*(paper.view.size.height+100);var o=-1,p=new paper.Path,q=new paper.Tool;paper.view.draw(),q.onMouseDown=function(a){if(a.point.x>0&&a.point.x<i)k.fillColor="#aaffaa";else{k.fillColor="#ffaaaa",showSplash("start your path within the far left rectangle",1e3);return}o=-1,p.removeSegments(),p.strokeColor="white",p.add(a.point),q.onMouseDrag=function(a){var b=a.point;o>b.x&&(b.x=o),o=b.x,p.add(b)},q.onMouseUp=function(a){q.onMouseDrag=null,q.onMouseUp=null,p.simplify();if(a.point.x>paper.view.size.width-j)m.fillColor="#aaffaa",r(p);else{m.fillColor="#ffaaaa",p.removeSegments(),showSplash("end your path within the far right rectangle",1e3);return}}}},initGame:function(){}};return a}()